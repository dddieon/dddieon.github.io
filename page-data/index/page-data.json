{"componentChunkName":"component---src-pages-index-tsx","path":"/","result":{"data":{"site":{"siteMetadata":{"title":"Dilog"}},"allMarkdownRemark":{"group":[{"fieldValue":"react"}],"nodes":[{"excerpt":"대충 saga의 작동방식  특정 request를 보내면 호출한 것을 감지하는 일종의 이벤트리스너 같은 모습이다. Thunk와 차이: Thunk에선 제공하지 않는 기능도 있음 setTimeout…","html":"<h2>대충 saga의 작동방식</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eab4f10f843908c80f0d48508ca3ff78/6acbf/saga2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.89873417721519%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGElEQVQoz42S228SURDGN+FFo4mtC9QuhdIVSosINvSC1iY+WN9ao7FQjIkFWjUobaq+Vh+8JiYm/EW1l3cTbfTRGNKm4bYgyEV2+bmQUE2N0S+ZMyfnzHzfzJwjKIpCLpenVquRTqfJ5nIUlTy5bIa9vT2y2SyapvKtoLC/v08qlSKfV1h5+JiR0QAXJ6cIjI/jGnTyZG0NodFoUK/XaflqtUqtodJUMtR1oVK1RqVaR9Xv1GqJHxrtGE3TmA+FMFsHcHl9SE43R7tNxBPLCJlMBkVXL5VKdNCsFKFR4RdU0Mqtm4OTl69ec3l6munrc1yaj+K/MsvzN28RCl8+onz9TDG9qys32+otfPrwnsVohPjibR7cjXIvcovYzRtEFxZYWrrDtauzPH32gl2lTCGXJa+P6Hu5jMAhqKra9u82NunukeizSvTbJCSrBdFkRDSexGwWOXL8GJGVR4fTEZrNJr9bh3B7c4OBYQ++C5OMnQ/gm5hg0OtBdrtxeM4i2mWWV1cPimh11soX9JW2HapwSye0D3uxj05hPxfA6h3D5nTRJzvpdwzRdaKL+/F4O7ZD1q7wby1vb20hu9yM+P34fR7ODLlwyAPIsh3HaRlRFEkkEv9PuL6+jvlULxabnV5JwmK1Yu4xY9TnZzSZMBgMxGKxfxN2XnlnZ4dQMEgwOEdQ/3NBfR/SfcvC4TAzMzMkk8k/CH8Ch/hYvW3TRqYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"saga패턴\"\n        title=\"saga패턴\"\n        src=\"/static/eab4f10f843908c80f0d48508ca3ff78/f058b/saga2.png\"\n        srcset=\"/static/eab4f10f843908c80f0d48508ca3ff78/c26ae/saga2.png 158w,\n/static/eab4f10f843908c80f0d48508ca3ff78/6bdcf/saga2.png 315w,\n/static/eab4f10f843908c80f0d48508ca3ff78/f058b/saga2.png 630w,\n/static/eab4f10f843908c80f0d48508ca3ff78/40601/saga2.png 945w,\n/static/eab4f10f843908c80f0d48508ca3ff78/6acbf/saga2.png 1001w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>특정 request를 보내면 호출한 것을 감지하는 일종의 이벤트리스너 같은 모습이다.</li>\n</ul>\n<h2>Thunk와 차이: Thunk에선 제공하지 않는 기능도 있음</h2>\n<ul>\n<li>setTimeout을 쉽게 구현하는 기능이나,</li>\n<li>쓰로틀링: 중복요청을 막는 방법. 마지막 요청만 인정해주거나 시간당 횟수 제한 등이 가능\n⇒ (스크롤이벤트시 요청이 수백개 가는 것을 방지할 때 씀)</li>\n</ul>\n<h2>설치</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> i redux-saga <span class=\"token operator\">||</span> <span class=\"token function\">npm</span> i next-redux-saga</code></pre></div>\n<h2>제너레이터의 원리로 만들어진다 (생성자 함수)</h2>\n<ul>\n<li>Generator : 빠져나갔다가 나중에 다시 돌아와도 사용가능한 함수. 이때 컨텍스트(변수 값)는 출입 과정에서 저장된 상태로 남아 있다.</li>\n</ul>\n<h2>사가 이펙트를 통한 여러 기능들</h2>\n<ol>\n<li>all : 배열을 받아와 한꺼번에 실행</li>\n<li><strong>fork</strong> : 비동기함수호출(요청 <strong>안기다림</strong>)</li>\n<li><strong>call</strong> : 동기함수호출(요청을 <strong>기다림</strong> - .then()처럼 작동)</li>\n<li>take : 액션을 기다림</li>\n<li>put : dispatch 와 동일</li>\n<li>delay</li>\n<li>debounce</li>\n<li>throttle</li>\n<li>takeLatest: 기존에 진행 중이던 작업이 있다면 취소 처리하고 가장 마지막으로 실행된 작업만 수행한다. (더블클릭 방지 등)</li>\n<li>takeEvery: take가 비동기로 동작함</li>\n<li>…</li>\n</ol>\n<h2>사용방법</h2>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 2개가 한 묶음이라고 보면 됨 (api요청함수 따로 / 요청감지함수 따로)</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">logInAPI</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api/login'</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">logIn</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">action</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">yield</span> <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//const result = yield call(logInAPI, action.data);</span>\n    <span class=\"token keyword\">yield</span> <span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token constant\">LOG_IN_SUCCESS</span><span class=\"token punctuation\">,</span>\n      data<span class=\"token operator\">:</span> action<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> <span class=\"token comment\">//성공결과</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">yield</span> <span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token constant\">LOG_IN_FAILURE</span><span class=\"token punctuation\">,</span>\n      error<span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> <span class=\"token comment\">//실패결과</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>saga가 요청을 감지하는 기능: take나 takeLatest나 takeEvery</h2>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//1 while문 쓰기</span>\n<span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">watchLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//이벤트리스너처럼 동작: 비동기액션생성함수가 \"특정이벤트\" 감지(두번째 매개변수 logIn을 감지한다)</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">yield</span> <span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token string\">'LOG_IN_REQUEST'</span><span class=\"token punctuation\">,</span> logIn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//2 takeEvery 쓰기</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> takeEvery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-saga/effects'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">watchLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">yield</span> <span class=\"token function\">takeEvery</span><span class=\"token punctuation\">(</span><span class=\"token string\">'LOG_IN_REQUEST'</span><span class=\"token punctuation\">,</span> logIn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>단, takeEvery시에는 서버쪽으로 요청은 연속으로 보내진다.</li>\n<li>응답만 취소할 뿐! 그러니 <strong>서버쪽에서 중복요청을 취소</strong>하도록 하자.</li>\n<li>일정시간동안 요청 막는 법인 throttle도 있다.</li>\n</ul>\n<h2>세팅 방법</h2>\n<ul>\n<li>컴바인리듀서 처럼 복잡하진 않다</li>\n<li>index.js에 여러 saga들을 묶어주자…</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// sagas/post.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">postSaga</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">yield</span> <span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token function\">fork</span><span class=\"token punctuation\">(</span>watchAddPost<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// sagas/index.js</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> all<span class=\"token punctuation\">,</span> fork <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-saga/effects'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> postSaga <span class=\"token keyword\">from</span> <span class=\"token string\">'./post'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> userSaga <span class=\"token keyword\">from</span> <span class=\"token string\">'./user'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">rootSaga</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">yield</span> <span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token function\">fork</span><span class=\"token punctuation\">(</span>postSaga<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">fork</span><span class=\"token punctuation\">(</span>userSaga<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","fields":{"slug":"/react/2021-08-04/"},"frontmatter":{"date":"August 04, 2021","title":"Redux Saga 사용하는 이유와 세팅 메모","description":"Thunk에서 제공하지 않는 기능을 제공하는 편이다.","category":"react"}},{"excerpt":"ref를 객체로 정의하고, 반복적으로 노드에 대한 참조값을 저장합시다. document.getElementBy를 지양하고 ref를 써야하는 이유 id는 중복선언을 하면 안된다. 하지만 사람은 언제나 실수를 할 수 있고, id…","html":"<blockquote>\n<p>ref를 객체로 정의하고, 반복적으로 노드에 대한 참조값을 저장합시다.</p>\n</blockquote>\n<h2>document.getElementBy를 지양하고 ref를 써야하는 이유</h2>\n<p>id는 중복선언을 하면 안된다.<br>\n하지만 사람은 언제나 실수를 할 수 있고, id를 중복선언할 수도 있다. (…ㅇㅅa;)</p>\n<p>이 경우에 전역적으로 작동하는 document.getElementById를 사용한다면<br>\n의도치 않게 다른 컴포넌트에까지 영향을 끼치게 된다.</p>\n<p>ref는 ref를 정의한 스코프 내에서만 작동하기 때문에<br>\nid 중복으로 인해 원하지 않는 결과가 생기는 것을 방지할 수 있다.</p>\n<h2>단계 1. 빈 객체로 useRef 선언</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> myRefs <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>키값을 사용해야 하니 null 말고 빈 객체를 디폴트로 쓴다.</p>\n<h2>단계 2. 선언한 ref 객체를 반복문에 넣어준다</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>useRef<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Sample</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> myRefs <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> arrayName <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>id<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> content<span class=\"token operator\">:</span> <span class=\"token string\">\"AA\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>id<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> content<span class=\"token operator\">:</span> <span class=\"token string\">\"BB\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>id<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> content<span class=\"token operator\">:</span> <span class=\"token string\">\"CC\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n            <span class=\"token punctuation\">{</span>\n                arrayName<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n                        <span class=\"token operator\">&lt;</span>div key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span> ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> myRefs<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">[</span>item<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> element<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n                            <span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">}</span>\n                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n                    <span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>반복문에서 생성된 3개의 DOM 엘리먼트는 각각의 참조값을 가진다.<br>\n이제 <code class=\"language-text\">myRefs.current.AA</code>, <code class=\"language-text\">myRefs.current.BB</code>, <code class=\"language-text\">myRefs.current.CC</code>를 사용해<br>\ndom을 조작할 수 있게 되었다.</p>\n<h2>단계 3. ref 사용해보기</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">useEffect(() =&gt; {\n    myRefs.current.CC.style.backgroundColor = &quot;red&quot;\n}, []);</code></pre></div>\n<p>CC는 빨개진다.</p>\n<p>끝!</p>","fields":{"slug":"/react/2021-06-17/"},"frontmatter":{"date":"June 17, 2021","title":"[react] useRef를 반복문에서 사용하기","description":"ref를 객체로 정의하고, 반복적으로 노드에 대한 참조값을 저장합시다.","category":"react"}}]}},"pageContext":{}},"staticQueryHashes":["2841359383","2881674200","508672574"]}